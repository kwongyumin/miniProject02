<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Spring has not Come</title>

    <meta property="og:title" content="Spring has not Come">
    <meta property="og:description" content="ë´„ì€ ì˜¤ì§€ ì•ŠëŠ”ë‹¤...">
    <meta property="og:image" content="/image/ogimage.jpg">

    <!--Bulma import-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">

    <!--    êµ¬ê¸€í°íŠ¸-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Gugi&family=Kirang+Haerang&display=swap"
          rel="stylesheet">

    <!--    favicon & gotag-->
    <link rel="shortcut icon" href="../static/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="../static/images/favicon.ico" type="image/x-icon">

    <!--    CSS-->
    <link rel="stylesheet" href="/css/detail.css">
    <link rel="stylesheet" href="../static/css/detail.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="/js/detail.js"></script>

    <script th:inline="javascript">
        $(document).ready(function () {
            // HTML ë¬¸ì„œë¥¼ ë¡œë“œí•  ë•Œë§ˆë‹¤ ì‹¤í–‰í•©ë‹ˆë‹¤.
            getComments();
        })

        function back_page() {
            window.location.href = '/';
        }

        function comment_save() {
            // let user = [[${user}]];
            // // ë¡œê·¸ì¸ ì—¬ë¶€ ê²€ì‚¬ì‹œ í•„ìš”
            let contents = $('#comment').val();
            let blogId = [[${data.id}]]

            let data = {'contents': contents, 'blogId': blogId};
            if (contents == '') {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.')
            } else {
                console.log(data);
                $.ajax({
                    type: "POST",
                    url: "/comments",
                    contentType: "application/json", // JSON í˜•ì‹ìœ¼ë¡œ ì „ë‹¬í•¨ì„ ì•Œë¦¬ê¸°
                    data: JSON.stringify(data),
                    success: function () {
                        alert('ëŒ“ê¸€ ì‘ì„± ì™„ë£Œ!');
                        window.location.reload();
                    }
                })
            }
        }

        function getComments() {
            // 1. ê¸°ì¡´ ë©”ëª¨ ë‚´ìš©ì„ ì§€ì›ë‹ˆë‹¤.
            $('#comment_group').empty();
            let user = [[${user}]]
            let commentList = [[${commentList}]]
            for (let i = 0; i < commentList.length; i++) {
                let contents = commentList[i].contents;
                let nickname = commentList[i].nickname;
                let modifiedAt = commentList[i].modifiedAt; //ì‹œê°„ì€ ë‚˜ì¤‘ì— ì¶”ê°€í•˜ì....
                let commentId = commentList[i].commentId;
                let tempHtml = ``
                if (user === nickname) {
                    tempHtml = `
        <!--        ëŒ“ê¸€ ëª©ë¡-->
        <div id="commentList">
            <article class="media">
                <div class="media-content">
                    <div class="content">
                        <p>
                            <strong id="username">${nickname}</strong>
                            <br id="comment_text">
                           ${contents}
                            <br>
                        </p>
                    </div>
                </div>
            </article>
        </div>`
                }
                    $('#comment_group').append(tempHtml);
            }
        }

    </script>

</head>

<body>
<div class="header">
    <div class="logout_btn">
        <span>ë´„ì´ ì˜¤ì§€ ì•Šì€  <span th:text="${username}"></span> ë‹˜</span>
        <form method="post" action="/user/logout">
            <button class="button is-dark">ë¡œê·¸ì•„ì›ƒ</button>
        </form>

    </div>

    <!--    ìƒë‹¨ ë°°ë„ˆ-->
    <div class="title">
        <h1>Spring has not Come</h1>
        <p>
        <h2>I will freeze to death soon...</h2>
        </p>
        <h2>ë‹¹ì‹ ì—ê²Œ ë´„ì´ ì˜¤ì§€ ì•Šì€ ì´ìœ ë¥¼ ì„œìˆ í•˜ì‹œì˜¤.(5ì )</h2>
    </div>
</div>

<div class="list" id="main_post_box">
    <!--ê¸€ ì‘ì„±í•˜ëŸ¬ ê°€ê¸° ë²„íŠ¼-->
    <div class="main-post">
        <article class="message is-dark">
            <div class="message-header">
                <p th:text="${data.title}"></p>
                <button onclick="back_page()" class="delete" aria-label="delete"></button>
            </div>
            <div class="dateTime">
                <article class="message is-dark">
                    <div class="message-body">
                        ğŸ“ ê¸€ì“´ì´ <span th:text="${data.username}"></span><span class="time_text">â³ï¸ <span th:text="${data.modifiedAt}"></span></span>
                    </div>
                </article>
            </div>

            <article class="message is-dark">
                <div class="message-body">
                    <span th:text="${data.contents}"></span>
                    <!--        ì‚­ì œë²„íŠ¼-->
                    <div class="delete_btn" onclick="deleteOne()" id="delete">
                        <button class="button is-black">ì‚­ì œí•˜ê¸°</button>
                    </div>
                </div>
            </article>
        </article>


        <!--        ëŒ“ê¸€ ë‹¬ê¸°-->
        <article class="media">
            <div class="media-content">
                <div class="field">
                    <p class="control">
                        <textarea id="comment" class="textarea" placeholder="Add a comment..."></textarea>
                    </p>
                </div>
                <div class="field">
                    <p class="control">
                        <button class="button" onclick="comment_save()">ëŒ“ê¸€ ë‹¬ê¸°</button>
                    </p>
                </div>
            </div>
        </article>

        <div id="comment_group">
            <!--        ëŒ“ê¸€ ëª©ë¡-->
            <div id="commentList">
                <article class="media">
                    <div class="media-content">
                        <div class="content">
                            <p>
                                <strong id="username">Kayli Eunice </strong>
                                <br id="comment_text">
                                Sed convallis scelerisque mauris, non pulvinar nunc mattis vel. Maecenas varius felis sit
                                amet magna vestibulum euismod malesuada cursus libero. Vestibulum ante ipsum primis in
                                faucibus orci luctus et ultrices posuere cubilia Curae; Phasellus lacinia non nisl id
                                feugiat.
                                <br>
                            </p>
                        </div>
                    </div>
                </article>
            </div>
        </div>


    </div>
    </article>
</div>

</body>

</html>